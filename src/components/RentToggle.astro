---
// RentToggle.astro - User preference for including rent/buy options

interface Props {
  userId: string;
  includeRent?: boolean;
}

const { userId, includeRent = false } = Astro.props;
---

<div class="flex items-center justify-between p-4 bg-gw-card border border-gw-border rounded-xl">
  <div>
    <h3 class="font-medium">Include Rent/Buy Options</h3>
    <p class="text-sm text-gw-text-secondary">Show movies available for rental with clear pricing</p>
  </div>
  <label class="relative inline-flex items-center cursor-pointer">
    <input 
      type="checkbox" 
      class="sr-only peer" 
      id="rent-toggle"
      checked={includeRent}
    />
    <div class="w-11 h-6 bg-gw-border peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gw-accent"></div>
  </label>
</div>

<script define:vars={{ userId }}>
  document.getElementById('rent-toggle')?.addEventListener('change', async (e) => {
    const includeRent = (e.target as HTMLInputElement).checked;
    
    // Save preference
    localStorage.setItem('gw_include_rent', includeRent.toString());
    
    // Could also save to server
    // await fetch('/api/preferences', {
    //   method: 'POST',
    //   headers: { 'Content-Type': 'application/json' },
    //   body: JSON.stringify({ userId, includeRent })
    // });
  });
  
  // Initialize from localStorage
  const saved = localStorage.getItem('gw_include_rent');
  if (saved !== null) {
    const toggle = document.getElementById('rent-toggle') as HTMLInputElement;
    if (toggle) toggle.checked = saved === 'true';
  }
</script>
