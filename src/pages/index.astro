---
import Layout from '../layouts/Layout.astro';
import { getTrendingMovies, getPosterUrl, MOODS, GENRES, slugify } from '../lib/supabase';

const trending = await getTrendingMovies(12);
const featuredMovie = trending[0];

// FAQ Schema for SEO
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How does GoodWatch recommend movies?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "GoodWatch uses mood-based tagging to match movies with how you're feeling. Each movie in our database is tagged with emotional descriptors, so we can suggest films that fit your current mood."
      }
    },
    {
      "@type": "Question",
      "name": "Is GoodWatch free to use?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes! GoodWatch is completely free. Browse movies by mood, discover what to watch, and find streaming availability at no cost."
      }
    },
    {
      "@type": "Question",
      "name": "Which streaming services does GoodWatch support?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "We show availability for major streaming platforms including Netflix, Amazon Prime Video, Disney+, Hulu, HBO Max, Apple TV+, and more."
      }
    },
    {
      "@type": "Question",
      "name": "How is GoodWatch different from other movie apps?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Unlike traditional movie databases, GoodWatch focuses on mood-based discovery. We don't just show you ratings â€“ we help you find movies that match how you want to feel."
      }
    }
  ]
};
---

<Layout 
  title="GoodWatch - Discover Movies Based on Your Mood"
  description="Find your next favorite movie based on how you feel. Browse by mood, genre, or explore curated lists. Free movie recommendations for Netflix, Prime Video, Disney+ and more."
  image={featuredMovie ? getPosterUrl(featuredMovie.backdrop_path, 'w1280') : undefined}
  schema={faqSchema}
>
  <!-- Hero Section -->
  <section class="relative min-h-[70vh] flex items-center justify-center overflow-hidden">
    <!-- Background -->
    {featuredMovie?.backdrop_path && (
      <div class="absolute inset-0">
        <img 
          src={getPosterUrl(featuredMovie.backdrop_path, 'w1280')} 
          alt=""
          class="w-full h-full object-cover opacity-30"
        />
        <div class="absolute inset-0 bg-gradient-to-t from-gw-bg via-gw-bg/80 to-transparent"></div>
      </div>
    )}
    
    <div class="relative z-10 text-center px-4 max-w-4xl mx-auto">
      <h1 class="text-4xl md:text-6xl font-bold mb-6">
        What do you feel like watching?
      </h1>
      <p class="text-xl text-gw-text-secondary mb-10 max-w-2xl mx-auto">
        Discover your next favorite movie based on your mood. No more endless scrolling.
      </p>
      
      <!-- Mood Quick Select -->
      <div class="flex flex-wrap justify-center gap-3 mb-8">
        {MOODS.slice(0, 8).map((mood) => (
          <a 
            href={`/mood/${slugify(mood)}`}
            class="px-5 py-2.5 bg-gw-card hover:bg-gw-accent hover:text-gw-bg border border-gw-border rounded-full transition font-medium"
          >
            {mood}
          </a>
        ))}
      </div>
      
      <a 
        href="/moods" 
        class="inline-flex items-center gap-2 text-gw-accent hover:text-gw-accent-hover transition"
      >
        See all moods
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
  </section>
  
  <!-- Trending Section -->
  <section class="py-16 px-4">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl md:text-3xl font-bold">Trending Now</h2>
        <a href="/trending" class="text-gw-accent hover:text-gw-accent-hover transition text-sm font-medium">
          View all â†’
        </a>
      </div>
      
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        {trending.map((movie) => (
          <a href={`/movie/${movie.tmdb_id}`} class="group">
            <div class="aspect-[2/3] rounded-lg overflow-hidden bg-gw-card mb-2">
              <img 
                src={getPosterUrl(movie.poster_path, 'w300')} 
                alt={movie.title}
                class="w-full h-full object-cover group-hover:scale-105 transition duration-300"
                loading="lazy"
              />
            </div>
            <h3 class="font-medium text-sm line-clamp-1 group-hover:text-gw-accent transition">
              {movie.title}
            </h3>
            <div class="flex items-center gap-2 text-xs text-gw-text-secondary">
              <span>{movie.year}</span>
              {movie.vote_average && (
                <>
                  <span>â€¢</span>
                  <span class="flex items-center gap-1">
                    <svg class="w-3 h-3 text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    {movie.vote_average.toFixed(1)}
                  </span>
                </>
              )}
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>
  
  <!-- Browse by Genre -->
  <section class="py-16 px-4 bg-gw-card/50">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl md:text-3xl font-bold">Browse by Genre</h2>
        <a href="/genres" class="text-gw-accent hover:text-gw-accent-hover transition text-sm font-medium">
          View all â†’
        </a>
      </div>
      
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        {GENRES.slice(0, 12).map((genre) => (
          <a 
            href={`/genre/${slugify(genre)}`}
            class="bg-gw-card hover:bg-gw-border border border-gw-border rounded-xl p-4 text-center transition group"
          >
            <span class="font-medium group-hover:text-gw-accent transition">{genre}</span>
          </a>
        ))}
      </div>
    </div>
  </section>
  
  <!-- App CTA -->
  <section class="py-20 px-4">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-6">
        Swipe to Discover
      </h2>
      <p class="text-xl text-gw-text-secondary mb-8 max-w-2xl mx-auto">
        Get the GoodWatch app for the full swipe-to-discover experience. 
        Like what you see? Swipe right. Not for you? Swipe left.
      </p>
      <a 
        href="/app" 
        class="inline-flex items-center gap-3 bg-gw-accent hover:bg-gw-accent-hover text-gw-bg px-8 py-4 rounded-full font-semibold text-lg transition"
      >
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
        </svg>
        Download for iOS
      </a>
    </div>
  </section>
  
  <!-- SEO Content -->
  <section class="py-16 px-4 border-t border-gw-border">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-2xl font-bold mb-6">Find Movies That Match Your Mood</h2>
      <div class="prose prose-invert prose-lg mb-12">
        <p class="text-gw-text-secondary">
          GoodWatch helps you discover movies based on how you're feeling right now. 
          Whether you want something uplifting after a long day, a thrilling adventure 
          for movie night, or a nostalgic classic that brings back memories â€“ we've got you covered.
        </p>
        <p class="text-gw-text-secondary">
          No more endless scrolling through streaming platforms. Tell us your mood, 
          and we'll show you movies that match. It's that simple.
        </p>
      </div>
      
      <h3 class="text-xl font-bold mb-4">Why Choose GoodWatch for Movie Discovery?</h3>
      <div class="grid md:grid-cols-2 gap-6 mb-12">
        <div class="bg-gw-card p-6 rounded-xl">
          <h4 class="font-semibold mb-2">ðŸŽ­ Mood-Based Recommendations</h4>
          <p class="text-gw-text-secondary text-sm">Find the perfect movie for your current mood. Feeling romantic? Need a laugh? We match movies to how you feel.</p>
        </div>
        <div class="bg-gw-card p-6 rounded-xl">
          <h4 class="font-semibold mb-2">ðŸŽ¬ Curated by Film Lovers</h4>
          <p class="text-gw-text-secondary text-sm">Our collection spans classics to new releases, all tagged with emotional context to help you decide faster.</p>
        </div>
        <div class="bg-gw-card p-6 rounded-xl">
          <h4 class="font-semibold mb-2">ðŸ“º Where to Watch</h4>
          <p class="text-gw-text-secondary text-sm">Instantly see which streaming services have your movie â€“ Netflix, Prime Video, Disney+, and more.</p>
        </div>
        <div class="bg-gw-card p-6 rounded-xl">
          <h4 class="font-semibold mb-2">ðŸ‘† Swipe to Discover</h4>
          <p class="text-gw-text-secondary text-sm">Use our iOS app to swipe through recommendations. Right for yes, left for no. Build your perfect watchlist.</p>
        </div>
      </div>
      
      <h3 class="text-xl font-bold mb-4">Popular Movie Moods</h3>
      <p class="text-gw-text-secondary mb-6">
        Looking for movies by mood? Here are our most popular mood categories: 
        <a href="/mood/feel-good" class="text-gw-accent hover:underline">feel-good movies</a>, 
        <a href="/mood/thrilling" class="text-gw-accent hover:underline">thrilling movies</a>, 
        <a href="/mood/romantic" class="text-gw-accent hover:underline">romantic movies</a>, 
        <a href="/mood/mind-bending" class="text-gw-accent hover:underline">mind-bending movies</a>, 
        <a href="/mood/nostalgic" class="text-gw-accent hover:underline">nostalgic movies</a>, and 
        <a href="/mood/funny" class="text-gw-accent hover:underline">funny movies</a>. 
        Each category is hand-curated to match the emotional experience you're looking for.
      </p>
      
      <h3 class="text-xl font-bold mb-4">Frequently Asked Questions</h3>
      <div class="space-y-4">
        <details class="bg-gw-card p-4 rounded-xl">
          <summary class="font-semibold cursor-pointer">How does GoodWatch recommend movies?</summary>
          <p class="text-gw-text-secondary text-sm mt-2">GoodWatch uses mood-based tagging to match movies with how you're feeling. Each movie in our database is tagged with emotional descriptors, so we can suggest films that fit your current mood.</p>
        </details>
        <details class="bg-gw-card p-4 rounded-xl">
          <summary class="font-semibold cursor-pointer">Is GoodWatch free to use?</summary>
          <p class="text-gw-text-secondary text-sm mt-2">Yes! GoodWatch is completely free. Browse movies by mood, discover what to watch, and find streaming availability at no cost.</p>
        </details>
        <details class="bg-gw-card p-4 rounded-xl">
          <summary class="font-semibold cursor-pointer">Which streaming services does GoodWatch support?</summary>
          <p class="text-gw-text-secondary text-sm mt-2">We show availability for major streaming platforms including Netflix, Amazon Prime Video, Disney+, Hulu, HBO Max, Apple TV+, and more.</p>
        </details>
        <details class="bg-gw-card p-4 rounded-xl">
          <summary class="font-semibold cursor-pointer">How is GoodWatch different from other movie apps?</summary>
          <p class="text-gw-text-secondary text-sm mt-2">Unlike traditional movie databases, GoodWatch focuses on mood-based discovery. We don't just show you ratings â€“ we help you find movies that match how you want to feel.</p>
        </details>
      </div>
    </div>
  </section>
</Layout>
